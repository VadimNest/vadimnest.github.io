import{D as W,H as C,F as U,a as D,L as X,b as P,_ as J,E as K,P as Q,G as Z,c as v,B as ee,S as ae,M as $,d as Y,e as oe,A as te,T as re,f as ne,g as se}from"./VUcNXDAA.js";import{m as ie,n as ce,r as de,p as le,o as he,q as pe}from"./DRVzkRDd.js";class ge extends W{constructor(m){super(m),this.type=C}parse(m){const h=function(e,r){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(r||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(r||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(r||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(r||""))}},n=`
`,u=function(e,r,i){r=r||1024;let p=e.pos,l=-1,a=0,g="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(p,p+128)));for(;0>(l=s.indexOf(n))&&a<r&&p<e.byteLength;)g+=s,a+=s.length,p+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(p,p+128)));return-1<l?(e.pos+=a+l+1,g+s.slice(0,l)):!1},y=function(e){const r=/^#\?(\S+)/,i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,d=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,p=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,a={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let g,s;for((e.pos>=e.byteLength||!(g=u(e)))&&h(1,"no header found"),(s=g.match(r))||h(3,"bad initial token"),a.valid|=1,a.programtype=s[1],a.string+=g+`
`;g=u(e),g!==!1;){if(a.string+=g+`
`,g.charAt(0)==="#"){a.comments+=g+`
`;continue}if((s=g.match(i))&&(a.gamma=parseFloat(s[1])),(s=g.match(d))&&(a.exposure=parseFloat(s[1])),(s=g.match(p))&&(a.valid|=2,a.format=s[1]),(s=g.match(l))&&(a.valid|=4,a.height=parseInt(s[1],10),a.width=parseInt(s[2],10)),a.valid&2&&a.valid&4)break}return a.valid&2||h(3,"missing format specifier"),a.valid&4||h(3,"missing image size specifier"),a},_=function(e,r,i){const d=r;if(d<8||d>32767||e[0]!==2||e[1]!==2||e[2]&128)return new Uint8Array(e);d!==(e[2]<<8|e[3])&&h(3,"wrong scanline width");const p=new Uint8Array(4*r*i);p.length||h(4,"unable to allocate buffer space");let l=0,a=0;const g=4*d,s=new Uint8Array(4),B=new Uint8Array(g);let V=i;for(;V>0&&a<e.byteLength;){a+4>e.byteLength&&h(1),s[0]=e[a++],s[1]=e[a++],s[2]=e[a++],s[3]=e[a++],(s[0]!=2||s[1]!=2||(s[2]<<8|s[3])!=d)&&h(3,"bad rgbe scanline format");let F=0,f;for(;F<g&&a<e.byteLength;){f=e[a++];const b=f>128;if(b&&(f-=128),(f===0||F+f>g)&&h(3,"bad scanline data"),b){const R=e[a++];for(let N=0;N<f;N++)B[F++]=R}else B.set(e.subarray(a,a+f),F),F+=f,a+=f}const O=d;for(let b=0;b<O;b++){let R=0;p[l]=B[b+R],R+=d,p[l+1]=B[b+R],R+=d,p[l+2]=B[b+R],R+=d,p[l+3]=B[b+R],l+=4}V--}return p},w=function(e,r,i,d){const p=e[r+3],l=Math.pow(2,p-128)/255;i[d+0]=e[r+0]*l,i[d+1]=e[r+1]*l,i[d+2]=e[r+2]*l,i[d+3]=1},S=function(e,r,i,d){const p=e[r+3],l=Math.pow(2,p-128)/255;i[d+0]=D.toHalfFloat(Math.min(e[r+0]*l,65504)),i[d+1]=D.toHalfFloat(Math.min(e[r+1]*l,65504)),i[d+2]=D.toHalfFloat(Math.min(e[r+2]*l,65504)),i[d+3]=D.toHalfFloat(1)},o=new Uint8Array(m);o.pos=0;const E=y(o),G=E.width,j=E.height,T=_(o.subarray(o.pos),G,j);let k,H,x;switch(this.type){case U:x=T.length/4;const e=new Float32Array(x*4);for(let i=0;i<x;i++)w(T,i*4,e,i*4);k=e,H=U;break;case C:x=T.length/4;const r=new Uint16Array(x*4);for(let i=0;i<x;i++)S(T,i*4,r,i*4);k=r,H=C;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:G,height:j,data:k,header:E.string,gamma:E.gamma,exposure:E.exposure,type:H}}setDataType(m){return this.type=m,this}load(m,t,M,L){function I(h,A){switch(h.type){case U:case C:h.colorSpace=X,h.minFilter=P,h.magFilter=P,h.generateMipmaps=!1,h.flipY=!0;break}t&&t(h,A)}return super.load(m,I,M,L)}}const ue=ie({__name:"figures",setup(q){const m={geometries:new Set,materials:new Set,textures:new Set,gui:null},t=ce({cube:{rotationSpeed:.5,color:"#00ff00",scale:1,height:2,position:{x:-2,y:1,z:-1}},sphere:{rotationSpeed:.3,color:"#ff0000",scale:1,height:2,position:{x:0,y:1,z:2}},door:{width:1,height:2,position:{x:3,y:1,z:1}}}),M=de(),L=(c,n,u=!1,y=!1)=>{const _=new $({color:n,metalness:.45,roughness:.65});m.geometries.add(c),m.materials.add(_);const w=new Y(c,_);return w.castShadow=y,w.receiveShadow=u,w},I=c=>{const n=new oe(16777215,1);n.position.set(5,5,2),n.castShadow=!0,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=.1,n.shadow.camera.far=20,n.shadow.camera.left=-10,n.shadow.camera.right=10,n.shadow.camera.top=10,n.shadow.camera.bottom=-10;const u=new te(16777215,.5);c.add(n,u)},h=(c,n,u)=>{const y=new se;m.gui=y;const _=y.addFolder("Куб");_.add(t.cube,"rotationSpeed",0,5,.1).name("Скорость вращения"),_.addColor(t.cube,"color").onChange(o=>{c.material.color.set(o)}),_.add(t.cube,"scale",.1,3,.1).name("Размер").onChange(o=>{c.scale.set(o,o,o)}),_.add(t.cube,"height",0,5,.1).name("Высота").onChange(o=>{c.position.y=o});const w=y.addFolder("Сфера");w.add(t.sphere,"rotationSpeed",0,5,.1).name("Скорость вращения"),w.addColor(t.sphere,"color").onChange(o=>{n.material.color.set(o)}),w.add(t.sphere,"scale",.1,3,.1).name("Размер").onChange(o=>{n.scale.set(o,o,o)}),w.add(t.sphere,"height",0,5,.1).name("Высота").onChange(o=>{n.position.y=o});const S=y.addFolder("Дверь");S.add(t.door,"width",.5,2,.1).name("Ширина").onChange(o=>{u.scale.x=o}),S.add(t.door,"height",1,3,.1).name("Высота").onChange(o=>{u.scale.y=o,u.position.y=o*2/2})},A=()=>{const c=new re,n=c.load("textures/figures/color.jpg");m.textures.add(n);const u=new v(2,2,100,100),y=new $({map:n,aoMap:c.load("./textures/figures/ambientOcclusion.jpg"),displacementMap:c.load("./textures/figures/height.jpg"),normalMap:c.load("./textures/figures/normal.jpg"),alphaMap:c.load("./textures/figures/alpha.jpg"),metalnessMap:c.load("./textures/figures/metalness.jpg"),roughnessMap:c.load("./textures/figures/roughness.jpg"),displacementScale:.1,aoMapIntensity:1,transparent:!0,side:ne});y.normalScale.set(2.5,2.5),m.geometries.add(u),m.materials.add(y);const _=new Y(u,y);return _.castShadow=!0,_.position.set(t.door.position.x,t.door.position.y,t.door.position.z),_},z=({scene:c,renderer:n})=>{new ge().load("textures/figures/background-2.hdr",E=>{E.mapping=K,c.background=E,c.environment=E}),n.shadowMap.enabled=!0,n.shadowMap.type=Q;const y=new Z,_=L(new v(10,10),"#fff",!0,!1);_.rotation.x=-Math.PI/2,_.position.y=0;const w=L(new ee(1,1,1),t.cube.color,!1,!0);w.position.set(t.cube.position.x,t.cube.position.y,t.cube.position.z);const S=L(new ae(.6,32,32),t.sphere.color,!1,!0);S.position.set(t.sphere.position.x,t.sphere.position.y,t.sphere.position.z),y.add(w,S),I(c);const o=A();c.add(_,y,o),h(w,S,o),M.value&&M.value.onTick(E=>{w.rotation.x=E*t.cube.rotationSpeed,w.rotation.y=E*(t.cube.rotationSpeed*.4)}),pe(()=>{var E;m.geometries.forEach(G=>G.dispose()),m.materials.forEach(G=>G.dispose()),(E=m.gui)==null||E.destroy(),m.textures.forEach(G=>G.dispose())})};return(c,n)=>{const u=J;return he(),le(u,{ref_key:"threeContainer",ref:M,"camera-position":[-10,5,10],"custom-animation":"",onSceneReady:z},null,512)}}});export{ue as default};
